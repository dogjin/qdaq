<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.18"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>QDaq: QDaq scripting API</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">QDaq
   &#160;<span id="projectnumber">0.2.6</span>
   </div>
   <div id="projectbrief">Qt-based Data Aqcuisition</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.18 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('group___script_a_p_i.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a>  </div>
  <div class="headertitle">
<div class="title">QDaq scripting API</div>  </div>
</div><!--header-->
<div class="contents">

<p>A Javascript API for <a class="el" href="namespace_q_daq.html">QDaq</a> based on QtScript.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_byte_array_prototype.html">ByteArrayPrototype</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">The prototype for the ByteArray class.  <a href="class_byte_array_prototype.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_q_daq_channel.html">QDaqChannel</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">A class that represent a stream of numerical data, a signal.  <a href="class_q_daq_channel.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_q_daq_data_buffer.html">QDaqDataBuffer</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">A class that provides storage of channel or other data.  <a href="class_q_daq_data_buffer.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_q_daq_job.html">QDaqJob</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_q_daq_loop.html">QDaqLoop</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">A class encapsulating a software loop.  <a href="class_q_daq_loop.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_q_daq_object.html">QDaqObject</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_vector_prototype.html">VectorPrototype</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">The prototype for the Vector class.  <a href="class_vector_prototype.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_q_daq_device.html">QDaqDevice</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">A class representing a DAQ device.  <a href="class_q_daq_device.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_q_daq_modbus_rtu.html">QDaqModbusRtu</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">A class for accesing a MODBUS/RTU connection.  <a href="class_q_daq_modbus_rtu.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_q_daq_modbus_tcp.html">QDaqModbusTcp</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">A class for accesing a MODBUS/TCP connection.  <a href="class_q_daq_modbus_tcp.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_q_daq_serial.html">QDaqSerial</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">A class for accesing a serial bus.  <a href="class_q_daq_serial.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_q_daq_tcpip.html">QDaqTcpip</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">A class for accesing a TCP/IP interface.  <a href="class_q_daq_tcpip.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_q_daq_linux_gpib.html">QDaqLinuxGpib</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">A class for accesing a GPIB interface.  <a href="class_q_daq_linux_gpib.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>A Javascript API for <a class="el" href="namespace_q_daq.html">QDaq</a> based on QtScript. </p>
<p><a class="el" href="namespace_q_daq.html">QDaq</a> offers a Javascript interface via the QtScript module.</p>
<p>One can use this scripting interface either to allow some user-defined behavior at some point inside a larger C++ application or alternatively to build the complete application in the scripting language.</p>
<p>It is possible to create <a class="el" href="namespace_q_daq.html">QDaq</a> objects from Javascript. These objects will continue to exist after the scripting session ends, as long as they become part of the <a class="el" href="namespace_q_daq.html">QDaq</a> object tree. Thus, complete aqcuisition loops can be created and executed in javascript in the same way as in C++.</p>
<p>Creation of GUI components and interaction between them and the <a class="el" href="namespace_q_daq.html">QDaq</a> objects can also be done using Javascript.</p>
<p>The scripting interface is based on the Qt meta-object system. When a <a class="el" href="namespace_q_daq.html">QDaq</a> object is exposed to the scripting environment, the signals and slots the QDaqObject-based class are available as methods of the javascript object. These methods can be called from javascript with the same arguments as in C++.</p>
<p>Similarly, the Qt properties of the C++ class become properties of the javascript object and can be read or changed from Javascript.</p>
<p><a class="el" href="namespace_q_daq.html">QDaq</a> objects has been designed so that the API they offer to Javascript (i.e., their signals, slots and properties) are sufficient to work with the objects for most purposes. Only a few special functions or <a class="el" href="namespace_q_daq.html">QDaq</a> extensions are acomplished only in C++.</p>
<p>The <a class="el" href="namespace_q_daq.html">QDaq</a> class documentation serves also as documentation of the scripting API as far as the signals, slots and properties of each class are concerned.</p>
<h1><a class="anchor" id="Started"></a>
Getting started with QDaq scripting</h1>
<p>The easiest way to get started with <a class="el" href="namespace_q_daq.html">QDaq</a> scripting is to start the qdaq_app application, open a scripting console and start executing Javascript commands interactively.</p>
<p>The <a class="el" href="namespace_q_daq.html">QDaq</a> root object (<a class="el" href="class_q_daq_object.html#a9f3d71496598a421c34fc099bcfcb1ae" title="Obtain a pointer to the one-and-only QDaqRoot object.">QDaqObject::root()</a>) is already defined in Javascript as the global property "qdaq".</p>
<p>If you type "qdaq" at the prompt and press enter the system reponds by showing that this is an object of class <a class="el" href="class_q_daq_root.html">QDaqRoot</a> with name "qdaq". Similarly if you check the "this" object the system reponds that it is an object of class <a class="el" href="class_q_daq_session.html">QDaqSession</a>:</p>
<pre class="fragment">&gt;&gt; qdaq
QDaqRoot(name = "qdaq")
&gt;&gt; this
QDaqSession(name = "session0")
&gt;&gt;
</pre><p>You will notice that the console has object introspection, i.e., pressing the '.' after a valid Javascript expression the system lists all properties and method of a given object.</p>
<h1><a class="anchor" id="Create"></a>
Creating objects in scripts</h1>
<p>All the classes <a href="#nested-classes">listed above </a> can be created in the scripting environment by the Javascript new operator with a single parameter, the object name</p>
<div class="fragment"><div class="line">var x = new QDaqObject(&quot;objname&quot;);</div>
</div><!-- fragment --><p>A hierarchy of <a class="el" href="namespace_q_daq.html">QDaq</a> objects can be built by using the <a class="el" href="class_q_daq_object.html">QDaqObject</a> <a class="el" href="class_q_daq_object.html#domapi">domapi</a>. Here is an example of script code that creates a loop with 2 channels:</p>
<div class="fragment"><div class="line">// create a loop</div>
<div class="line">var loop = new QDaqLoop(&quot;loop&quot;);</div>
<div class="line">// create a clock channel</div>
<div class="line">var t = new QDaqChannel(&quot;t&quot;);</div>
<div class="line">t.type = &quot;Clock&quot;;</div>
<div class="line">// create a test random channel</div>
<div class="line">var ch1 =  new QDaqChannel(&quot;ch1&quot;);</div>
<div class="line">ch1.type = &quot;Random&quot;;</div>
<div class="line">// create a 2nd channel</div>
<div class="line">var ch2 = new QDaqChannel(&quot;ch2&quot;);</div>
<div class="line">// create a script job</div>
<div class="line">// that will write to ch2 the square root of ch1</div>
<div class="line">var scr = new QDaqJob(&quot;scr&quot;);</div>
<div class="line">scr.code = &quot;var v = qdaq.loop.ch1.value(); qdaq.loop.ch2.push(Math.sqrt(v));&quot;</div>
<div class="line">// build the object hierarchy under the root object &quot;qdaq&quot;</div>
<div class="line">loop.appendChild(t);</div>
<div class="line">loop.appendChild(ch1);</div>
<div class="line">loop.appendChild(scr);</div>
<div class="line">loop.appendChild(ch2);</div>
<div class="line">qdaq.appendChild(loop);</div>
</div><!-- fragment --><p>After the above script code has been executed a call to objectTree() would return the following: </p><pre class="fragment">&gt;&gt; qdaq.objectTree()
qdaq
|--loop
|  |--t
|  |--ch1
|  |--scr
|  |--ch2
</pre><h1><a class="anchor" id="Hierarchy"></a>
Traversing the object hierarchy</h1>
<p>The are many ways to traverse the <a class="el" href="namespace_q_daq.html">QDaq</a> object hierarchy from Javascript.</p>
<p>All objects are descendants of the root object "qdaq". The child objects of an object are Javascript properties of that object. Thus, in the above example we can obtain the object "ch2" like this</p>
<div class="fragment"><div class="line">var my_ch2 = qdaq.loop.ch2;</div>
</div><!-- fragment --><p>Alternatively, if we do not know the path to the object, we can use the built-in QtScript functions findChild and findChildren which try to find an object based on its name. All <a class="el" href="namespace_q_daq.html">QDaq</a> object must have a name! Thus, to obtain "ch2" with this method we would do</p>
<div class="fragment"><div class="line">var my_ch2 = qdaq.findChild(&quot;ch2&quot;);</div>
</div><!-- fragment --><p>If there are more than one descendant objects with the same name, findChild() will return the 1st that it will find (closer relatives are discovered first). The function findChildren will return an array of all objects with the same name.</p>
<h1><a class="anchor" id="Threads"></a>
Interactive vs in-loop Javascript</h1>
<p>There two different kinds of Javascript environments in <a class="el" href="namespace_q_daq.html">QDaq</a>.</p>
<p>The 1st one runs in the main application thread and can execute either interactively on a console or in the background running some script. This kind of environment has typically access to all application objects: the <a class="el" href="namespace_q_daq.html">QDaq</a> object hierarchy, the UI widgets, the special functions for system interaction (filesystem, command execution) etc</p>
<p><a class="el" href="namespace_q_daq.html">QDaq</a> has one standard such Javascript environment that is never deleted and it is called "root script session". It can be accesed by the function <a class="el" href="class_q_daq_root.html#ae5bed36b118927b2c910e8d7dba3fc10" title="Returns a pointer to the root script session.">QDaqRoot::rootSession()</a>. If we need to define Jacascript functions that must exist throught the lifetime of the application, then we have to define them in the root session. A typical example of such a function is when we want to define UI logic in Javascript, e.g. a button press calls a Javascript funtion that performs the required action.</p>
<p>A second kind of Javascript environment exists only within a <a class="el" href="class_q_daq_loop.html" title="A class encapsulating a software loop.">QDaqLoop</a> and it serves the purpose of running code of the loop's <a class="el" href="class_q_daq_job.html">QDaqJob</a> objects. This environment runs in the separate loop thread and has only access to the <a class="el" href="namespace_q_daq.html">QDaq</a> objects via the qdaq global object.</p>
<p>If we have <a class="el" href="class_q_daq_job.html">QDaqJob</a> objects that need to run Javascript code during execution of their parent loop, then we must create a scripting engine at the top-level loop by calling <a class="el" href="class_q_daq_loop.html#a599396e9e90ad42df14aa1157f169e46" title="Create a dedicated QDaqScriptEngine.">QDaqLoop::createLoopEngine()</a>.</p>
<h1><a class="anchor" id="UI"></a>
Creating user interface (UI) components</h1>
<p>In Javascript UI components can be loaded from *.ui files that have been created by QtDesigner or QtCreator.</p>
<p>There are 2 functions to accomplish this: <a class="el" href="class_q_daq_session.html#a0974fb53655e1cb2e56deaf60bd4421f">QDaqSession::loadUi()</a> and <a class="el" href="class_q_daq_session.html#a29cbde7124a00cbf13aa7442d985aa9e">QDaqSession::loadTopLevelUi()</a>.</p>
<p>Both take a *.ui file name as input and generate a QWidget according to the specifications in the file. The simple loadUi() function generates a bare QWidget whereas loadTopLevelUi() generates a top level <a class="el" href="namespace_q_daq.html">QDaq</a> window. Using these two functions, a complete UI can be built. This is shown in the following code example.</p>
<p>The main application window is a tab widget with 2 tabs. We create it in QtDesigner and give each of the tabs a representative name. The form we create in QtDesigner should be a plain QWidget or a QTabWidget. Do not use a QMainWindow or other top-level widget types.</p>
<p>We additionally create in QtDesigner two widgets that contain all the components (buttons, display fields, etc) that we need in each tab.</p>
<p>The following <a class="el" href="namespace_q_daq.html">QDaq</a> script code creates the widgets and combines them to form the final application window.</p>
<div class="fragment"><div class="line">// create top level application window - a tab widget</div>
<div class="line">var w = loadTopLevelUi(&#39;tabwidget.ui&#39;,&#39;mainForm&#39;);</div>
<div class="line">// create the widget for the 1st tab</div>
<div class="line">var to = loadUi(&#39;tab1.ui&#39;);</div>
<div class="line">// find the current 1st tab widget in the main window</div>
<div class="line">var from = w.findChild(&#39;tab1&#39;);</div>
<div class="line">// replace it with the one loaded from the file</div>
<div class="line">w.replaceWidget(from,to);</div>
<div class="line">// repeat for the second tab</div>
<div class="line">to = loadUi(&#39;tab2.ui&#39;);</div>
<div class="line">from = w.findChild(&#39;tab2&#39;);</div>
<div class="line">w.replaceWidget(from,to);</div>
</div><!-- fragment --><p>To be able to locate the various UI components we have to give them a name in QtDesigner. Then, when a form is loaded in Javascript, use findChild() or findChildren() to get the UI widgets.</p>
<h1><a class="anchor" id="FullApp"></a>
Creating a full app in Javascript</h1>
<p>To create a full <a class="el" href="namespace_q_daq.html">QDaq</a> application in Javascript the following steps are needed:</p><ul>
<li>Create the user interface forms with QtDesigner or QtCreator</li>
<li>Write a script that loads the UI files and defines the UI logic</li>
<li>Implement the main application DAQ tasks by means of <a class="el" href="namespace_q_daq.html">QDaq</a> objects</li>
<li>Start your <a class="el" href="namespace_q_daq.html">QDaq</a> loops</li>
</ul>
<p>The application can be executed with the qdaq_app application.</p>
<p>A recomended folder organization is to have a root folder with the application name, a subfolder named "scripts" for the script files and a subfolder named "ui" for the *.ui files. Then qdaq_app is run from the root folder </p><div class="fragment"><div class="line">&gt;qdaq scripts/main.js</div>
</div><!-- fragment --><p> assuming that "main.js" is the application script.</p>
<p><a class="el" href="namespace_q_daq.html">QDaq</a> will create a "log" subfolder to store its log files.</p>
<h1><a class="anchor" id="Extensions"></a>
QDaq Javascript tricks</h1>
<p><a class="el" href="namespace_q_daq.html">QDaq</a> defines some special Javascript objects.</p>
<p>The <a class="el" href="class_byte_array_prototype.html" title="The prototype for the ByteArray class.">ByteArrayPrototype</a> class defines essentially a new Javascript object class named "ByteArray" that allows low-level manipulation of arrays of bytes. This is usefull for DAQ work, when we need byte-wise memory access which is not possible by default in Javascript.</p>
<p>C++ Enumeration types that are properties of <a class="el" href="namespace_q_daq.html">QDaq</a> objects are manipulated from Javascript by strings with the enumeration name that appears in C++ code. E.g., to set the <a class="el" href="class_q_daq_channel.html#aeedd7ab3fa27546657492724e32c85d7">QDaqChannel::format</a> property we pass a string</p>
<div class="fragment"><div class="line">// Create a QDaq channel and set the number format to fixed point</div>
<div class="line">var ch = new QDaqChannel(&quot;ch1&quot;);</div>
<div class="line">ch.format = &quot;FixedPoint&quot;;</div>
</div><!-- fragment --><h1><a class="anchor" id="Ref"></a>
A synopsis of QDaq objects</h1>
<p><a class="el" href="class_q_daq_object.html">QDaqObject</a> Directly derived from Qt’s QObject</p>
<p><a class="el" href="class_q_daq_root.html">QDaqRoot</a> The easier way to visualize the hierarchy of objects of the running qdaq session is to use the Object Browser window of the <a class="el" href="namespace_q_daq.html">QDaq</a> IDE. There, all the objects are represented in tree form. The base qdaq object is a <a class="el" href="class_q_daq_root.html">QDaqRoot</a> object.</p>
<p><a class="el" href="class_q_daq_session.html">QDaqSession</a> The basic instance of an interaction with all other existing objects and ui’s that do all the work in data taking. It is designed to function in JS, by providing an “interface” or “translation service” to C++/Qt’s objects to JS much more nimble and low-weight, pointer-based objects. Any qdaq console is a <a class="el" href="class_q_daq_session.html">QDaqSession</a> object.</p>
<p><a class="el" href="class_q_daq_job.html">QDaqJob</a> “Anything that actively <em>does</em> something” (instead of just existing) in <a class="el" href="namespace_q_daq.html">QDaq</a>.</p>
<p><a class="el" href="class_q_daq_channel.html" title="A class that represent a stream of numerical data, a signal.">QDaqChannel</a> The basic object for interaction with instruments and data taking, keeping and interacting with measurements.</p>
<p><a class="el" href="class_q_daq_interface.html" title="Base class of objects representing digital communications interfaces.">QDaqInterface</a> <a class="el" href="class_q_daq_interface.html" title="Base class of objects representing digital communications interfaces.">QDaqInterface</a> provides a common way to communicate with (hardware) instruments. The actual communication interface of the instruments connected to the control computer may vary (examples include GPIB, TCP/IP and Modbus protocols).</p>
<p>A <a class="el" href="class_q_daq_interface.html" title="Base class of objects representing digital communications interfaces.">QDaqInterface</a> has a number of communication "ports", which have different meaning depending on the specific interface implementation. On memory/register based interfaces like MODBUS, a port represents the register number to be read/written. On interfaces that support connection with multiple instruments (GPIB, RS485), the port is essentially the address of each instrument. On interfaces that support only one-to-one communication with an instrument (RS232, TCP/IP) the port feature is not used.</p>
<p><a class="el" href="class_q_daq_device.html" title="A class representing a DAQ device.">QDaqDevice</a> A <a class="el" href="class_q_daq_device.html" title="A class representing a DAQ device.">QDaqDevice</a> is the software representation of a hardware device connected to the control computer. In order for the computer to interact with a device, the device and its interface have to be created as software objects, and the device has to be assigned to an interface. Then, both the interface and the device have to be opened.</p>
<p>At that point, the user can communicate with the device (send commands or get measurements), according to each devices specific communication protocols (e.g. SCPI commands or even whole scripts), using just the read() and write() functions.</p>
<p><a class="el" href="class_q_daq_filter.html">QDaqFilter</a> A <a class="el" href="class_q_daq_filter.html">QDaqFilter</a> is the software implementation of a mathematical process (usually quite complicated), that has to be applied online to the values of one or more QDaqChannels.</p>
<p>At present, QDaqFilters can be: FOPDT (First-Order-Plus-Dead-Time control) Interpolator (As the name shows, finds values between measured or available ones) Linear Correlator (Finds correlation -linear fitter- between values presented) PID (Proportional-Integral-Differential control)</p>
<p><a class="el" href="class_q_daq_data_buffer.html" title="A class that provides storage of channel or other data.">QDaqDataBuffer</a> The basic object of data keeping, where the actual values measured are kept in memory, relatively organized, before being saved to disk.</p>
<p>Thought the object can function in two alternative ways, either by attaching to QDaqChannels and reading their content, or by getting values pushed independently by the user, in practice only the first way of data logging is used.</p>
<p>The data logging involves 4 different objects, 2 QLists: channel_objects is a QDaqObjectList, i.e. a QList&lt;QDaqObject&gt;</p>
<p>columnNames_ is a QStringList, i.e. a QList&lt;QString&gt; -This stores the names of the columns in the sense of C++/Qt object names (which may be different from the user interface channel names!). This is done in order to have a human-friendly way to access the two following objects.</p>
<p>And 2 QVectors: data_matrix is a QVector of <a class="el" href="class_q_daq_vector.html" title="A buffer for storing double numbers.">QDaqVector</a> objects QVector&lt;QDaqVector&gt; -<a class="el" href="class_q_daq_vector.html" title="A buffer for storing double numbers.">QDaqVector</a> is a special <a class="el" href="namespace_q_daq.html">QDaq</a> class holding QExplicitlySharedDataPointer objects to other special <a class="el" href="namespace_q_daq.html">QDaq</a> objects (essentially lists of double numbers), see below. data_matrix is where the data are actually read into, and kept. It can be thought of as a 2-D matrix, where each column represents a channel (<a class="el" href="class_q_daq_channel.html" title="A class that represent a stream of numerical data, a signal.">QDaqChannel</a>), and each row a measurement point (presumably done at every iteration of a loop containing the <a class="el" href="class_q_daq_data_buffer.html" title="A class that provides storage of channel or other data.">QDaqDataBuffer</a>, and presumably sync’d with the measurements of the channels. (See below about the concept of a depth of a data channel).</p>
<p>channel_ptrs This is a QVector holding QPointers to QDaqChannels, i.e. a QVector&lt;QPointer&lt;QDaqChannel&gt;&gt;. This gives an extra handle to interact with the constituents</p>
<p>These four objects have to change in unison in order for the data recording to be well behaved, and therefore all 4 of them have to be in principle interacted with when interacting with data.</p>
<p>Qt has tried to provide all methods available to QList also to QVector objects, and vice-versa, hence all four objects can be treated almost in the same way</p>
<p>It is also implicitly true that the order of objects (QDaqChannels, names, pointers, data columns) is the same across all 4 objects, to facilitate access, although the objects are not absolutely ordered in any sense.</p>
<p>A data recording loop that runs without input (e.g. a loop containing a <a class="el" href="class_q_daq_data_buffer.html" title="A class that provides storage of channel or other data.">QDaqDataBuffer</a> that is not running concurrently with any data-producing, i.e. QDaqChannel-containing loop, is filled with zeros. This behaviour may need to change, in order to separate “real” zero values from accidental no input.</p>
<p>Depth</p>
<p>If the thread of data creation in a channel is too busy to communicate available data to the thread of data recording (e.g. during very fast loops), data are pushed in a provisional “buffer”. This process changes the value of special indexes (semaphores), that alert the data recording thread that data is available. The number of positions of this provisional buffer can be set for each channel, and is the (data) channel’s “depth” properties</p>
<p>In order for a data channel to be created and deleted successfully, care must be taken to also ‘populate’ or ‘depopulate’ its properties also.</p>
<h1><a class="anchor" id="Ref"></a>
A synopsis of QDaq objects</h1>
<p>For <a class="el" href="namespace_q_daq.html">QDaq</a> objects and their Javascript API refer to the documentation of the <a href="#nested-classes">classes listed above</a> and other <a class="el" href="namespace_q_daq.html">QDaq</a> classes. All properties, signals and slots are available in Javascript and essentially constitute the <a class="el" href="namespace_q_daq.html">QDaq</a> Scripting API.</p>
<p>Resources for Javascript and QtScript:</p><ul>
<li>An excellent book for Javascript is "JavaScript: the definitive guide" by D. Flanagan.</li>
<li>Mozilla offers many Javascript resources at <a href="https://developer.mozilla.org/en-US/docs/Web/javascript">developer.mozilla.org.</a></li>
<li>Also the W3 organization has Javascript material here <a href="https://www.w3schools.com/js/DEFAULT.asp">www.w3schools.com.</a></li>
<li>The QtScript module documentation from the official Qt web-site <a href="https://doc.qt.io/qt-5/qtscript-index.html">doc.qt.io.</a> explains many implementation details on the C++/Javascript duality.</li>
<li>The QtScript Javascript engine implements the ECMA-262 language standard which is described <a href="https://doc.qt.io/qt-5/ecmascript.html">here.</a> </li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.18 </li>
  </ul>
</div>
</body>
</html>
